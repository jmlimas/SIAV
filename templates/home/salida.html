{% extends "home/base.html" %}

{% load dayssince %}

{% block salida %}active{% endblock %}

{% block script %}
<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}JS/jquery.dataTables.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}CSS/bootstrap/css/dataTables.boostrap.css">
<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}/JS/dataTables.tableTools.js"></script>
<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}/JS/dataTables.bootstrap.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}CSS/smart-admin.css">
<script type="text/javascript">
$(document).ready(function () {
$(document).ready( function() {
    var oTable = $('#avaluos_table').DataTable({
        "dom": '&t;"tof"T<"clear">i&gtlp;',
        "tableTools": {
            "sSwfPath": "{{ STATIC_URL }}swf/copy_csv_xls_pdf.swf"
        },
     }

      );

 $("#avaluos_table #thead_2 th").each( function ( i ) {
        var select = $('<select style="max-width:60px; ><option style="max-width:60px; value=""></option></select>')
            .appendTo( $(this).empty() )
            .on( 'change', function () {
                oTable.column( i )
                    .search( $(this).val() )
                    .draw();
            } );
           select.append( '<option value="'+" "+'" style="max-width:60px;">'+"-----"+'</option>' )
           oTable.column( i ).data().unique().sort().each( function ( d, j ) {
            select.append( '<option value="'+d+'" style="max-width:60px;">'+d+'</option>' )

        } );



      } );      


     } );

  $('#id_Visita').datepicker({ autoSize: true , dateFormat: 'dd/mm/yy'});



});



</script>
{% endblock %}      

{% block content %}
<div class="table-responsive">
<div class="jarviswidget jarviswidget-color-darken jarviswidget-sortable" id="wid-id-0" data-widget-editbutton="false" role="widget">
<div align="center">
<h1>Salida</h1>
</div>
<span class="jarviswidget-loader">
  <i class="fa fa-refresh fa-spin"></i>
</span>
<div role="content" id="table-my-content">
<div class="jarviswidget-editbox"></div>
<div id="dt_basic_wrapper" class="dataTables_wrapper form-inline" role="grid">
<div class="dt-wrapper">
  <div class="table-responsive ">
  <table id='avaluos_table' class="table table-hover">
    <thead>
      <tr>
        <th>Folio K</th>
        <th >Ref.</th>
        <th>Cliente</th>
        <th>Calle</th>
        <th>Ext.</th>
        <th>Int.</th>
        <th >Colonia</th>
        <th >Municipio</th>
        <th >Prio.</th>
        <th >Status</th>
        <th >Dias</th>
        <th >Salida</th>
      </tr>
    </thead>
        <thead id="thead_2">
        <th>Folio K</th>
        <th>Ref.</th>
        <th>Cliente</th>
        <th>Calle</th>
        <th >Ext.</th>
        <th >Int.</th>
        <th >Colonia</th>
        <th >Municipio</th>
        <th >Prio.</th>
        <th >Estatus</th>
        <th>Dias</th>
        </thead>
    <tbody>
      {% for a in avaluos %}
      <tr class="{% if a.Solicitud|dayssince|add:"0" > a.Depto.Tolerancia|add:"0" and a.Estatus != 'DETENIDO' %}danger{% endif%}">
        <td>{{a.FolioK}}</td>
        <td>{{a.Referencia}}</td>
        <td>{{a.Cliente}}</td>
        <td>{{a.Calle}}</td>
        <td>{{a.NumExt}}</td>
        <td>{{a.NumInt}}</td>
        <td>{{a.Colonia}}</td>
        <td>{{a.Municipio}}</td>
        <td>{{a.Prioridad}}</td>
      <td ><span class="label label-{%if a.Estatus = 'PROCESO'%}success{%elif a.Estatus = 'DETENIDO'%}default{%endif%}">{{a.Estatus}}</span></td>
        <td>{{ a.Solicitud|dayssince }}</td>
        <td>
          <a href="/SIAV/edita_salida/{{a.avaluo_id}}"><button type="button" class="btn btn-primary btn-sm">
  <span class="glyphicon glyphicon-edit"></span> </button></a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
    </div>
  </div>
</div>
</div>
</div>
</div>
{% for a in avaluos %}
<!-- Modal1 -->
<div id="myModal{{a.FolioK}}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h3 align="center" id="myModalLabel">{{a.FolioK}}</h3>
	</div>
	<div class="modal-body">
		<p align="center">¿Estás seguro que deseas dar salida a este servicio?</p>
	</div>
	<div class="modal-footer">
		<button class="btn" data-dismiss="modal" aria-hidden="true">Cancelar</button>
		<a href="/SIAV/salida_efectiva/{{a.avaluo_id}}" role="button" class="btn btn-primary">Confirmar</a>
	</div>
</div>
{% endfor %}


{% endblock %}
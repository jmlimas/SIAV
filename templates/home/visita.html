{% extends "home/base.html" %}

{% load dayssince %}

{% load bootstrap3 %}

{% bootstrap_css %}
{% bootstrap_javascript %}

{% block visita %}active{% endblock %}

{% block script %}

<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}JS/jquery.dataTables.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}CSS/bootstrap/css/dataTables.boostrap.css">
<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}/JS/dataTables.bootstrap.js"></script>

<script type="text/javascript">
$(document).ready(function () {
$(document).ready( function() {
     $('#avaluos_table').dataTable( {
        "dom": '&t;"tof"i&gtlp;'
     } );
     } );

  $('#id_Visita').datepicker({ autoSize: true , dateFormat: 'dd/mm/yy'});



});



</script>
<style>
.modal-content {
  width: 900px;
  margin-left: -150px;
}
</style>
{% endblock %}      

{% block content %}
<h1>Visita</h1>
{% if forma.errors %}
<p style="color: red;">Porfavor completa los campos faltantes.</p>
{% endif %}
<div class="caption">
<p>
  <a data-toggle="modal" data-target="#visita_masiva" href="#visita_masiva" title="Visita" style="float:right" class="btn btn-success" role="button">
    <span class="glyphicon glyphicon-ok"></span>
    VISITAR
  </a>
</p>
</div>
  <br>
  <br>
<div class="table-responsive ">
<table id='avaluos_table' class="table">
  <thead>
    <tr class='even'>
      <th></th>
      <th >Folio K</th>
      <th>Ref.</th>
      <th>Cliente</th>
      <th>Calle</th>
      <th>Ext.</th>
      <th>Int.</th>
      <th>Colonia</th>
      <th>Municipio</th>
      <th>Prio.</th>
      <th>Estatus</th>
      <th>Dias</th>
      <th>Opciones</th>
    </tr>
  </thead>
  <tbody>
    {% for a in avaluos %}
    <tr class="{% if a.Solicitud|dayssince|add:"0" > a.Depto.Tolerancia|add:"0" and a.Estatus != 'DETENIDO'%}danger{% endif%}">
      <form id="modal-form" class="form-horizontal" method="post" action="/SIAV/visita_masiva/">
        <td>
          <input type="checkbox" value="{{ a.avaluo_id }}" name="avaluo_visitado"></td>
        <td >{{a.FolioK}}</td>
        <td >{{a.Referencia}}</td>
        <td >{{a.Cliente}}</td>
        <td >{{a.Calle}}</td>
        <td >{{a.NumExt}}</td>
        <td >{{a.NumInt}}</td>
        <td >{{a.Colonia}}</td>
        <td>{{a.Municipio}}</td>
        <td >{{a.Prioridad}}</td>
        <td >{{a.Estatus}}</td>
        <td >{{ a.Solicitud|dayssince }}</td>
        <td class="tabla_opciones">
          <a href="/SIAV/edita_visita/{{a.avaluo_id}}">Visita</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="modal fade" id="visita_masiva">

  <div class="modal-dialog">
    t
    <div class="modal-content">
      <div class="modal-body">

        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h2 style="text-align:center">Visita MÃºltiple</h2>
        <div class="modal-footer">
          <span style="display: block">
            {% if not visita_masiva.is_valid %}
            <div class='hide'>invalid_form</div>
            {% endif %}
          {% csrf_token %}
          {% bootstrap_form visita_masiva layout='horizontal'  %}
          </span>
        </div>
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-success" style="float:right">Enviar</button>
      </div>
    </div>
    <!-- /.modal-content --> </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
</form>
{% endblock %}
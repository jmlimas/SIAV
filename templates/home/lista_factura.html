{% extends "home/base.html" %}

{% load crispy_forms_tags %}

{% load dayssince %}

{% load currency %}

{% block lista_factura %}active{% endblock %}


{% block style %}

<style>

.control-group {
margin-bottom: 0px;
}

.textinput.textInput{
margin-bottom: 0px; 
}

input[type=text]{
  width:100px;
}
</style>

{% endblock %}

{% block script %}

<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}JS/picnet-table.js"></script>
<script type="text/javascript" language="javascript" src="{{ STATIC_URL }}JS/jquery.livequery.js"></script> 

<script type="text/javascript">
$(document).ready(function () {
  $('#avaluos_table').tableFilter();
  valor = 0;

  var rowCount = { p: $('#avaluos_table tbody tr:visible').length };
  valor = ($('#avaluos_table tbody tr:visible').length);

  $('#cantidad_tabla').html(valor);

  $('#avaluos_table thead').on("change", function () {
    setTimeout(function () {
      window.location = '/SIAV/facturar/';
    }, 1000);
  });


});

</script>

{% endblock %}      
{% block content %}

<h1>Servicios por Facturar</h1>

<table class="table table-hover">
  <th>Cliente</th>
  <th>Importe</th>
  {% for cliente in suma_de_monto %}
  <tr>
    <td>{{cliente.Cliente__Cliente}}</td>
    <td>{{cliente.total|currency}}</td>
  </tr>
  {% endfor %}
  <tr>
    <td><b>Total:</td></b>
    <td>{{total_general|currency}}</td>
  </tr>
</table>

<h2 style="text-align:left"><span id="cantidad_tabla"></span>  Servicios</h2>
<div class="table-responsive">
<table id='avaluos_table' class="table table-striped col-md-20">
 <thead>
  <tr class='even'><th id="folio_type" filter-type="ddl" style="width:40px">Folio K</th><th style="width:150px" filter='false' >Ref.</th><th filter-type='ddl'>Cliente</th><th filter-type='ddl'>Depto</th><th filter="false">Calle</th><th filter='false'>Ext.</th><th filter='false'>Int.</th><th style="width:100px" filter='false'>Factura</th><th filter='false'>Municipio</th><th  filter='false'>Entrega</th><th filter='false'>Monto</th><th filter='false' class="tabla_opciones">Opciones</th></tr>
</thead>
<tbody>
  <form action="/SIAV/facturar/" method="post">
    {{example_formset.management_form }}
    {% for a,b in olist %}
    {{ b.id }}
    <tr class="{% cycle 'odd' 'even' %}">
     <td> {{a.FolioK}} </td>
     <td> {{a.Referencia}} </td>
     <td> {{a.Cliente}} </td>
	 <td> {{a.Depto}} </td>
     <td> {{a.Calle}} </td>
     <td style="width:3px;"> {{a.NumExt}} </td>
     <td style="width:10px;"> {{a.NumInt}} </td>
     <td style="width:10px;"> {% crispy b %} </td>
     <td> {{a.Municipio}} </td>
     <td> {{a.Salida|date:"d/m/y"}} </td>
     <td> {{a.Importe|currency }}</td>			  
     <td class="tabla_opciones"> <a href="/SIAV/guarda_master/{{a.avaluo_id}}" target="_blank">Editar</a></td>
   </tr>
   {% endfor %} 

   <input class='btn btn-primary' type="submit" name="submit" value="Facturar" />

 </form>
</tbody>

</table>
</div>


{% endblock %}
